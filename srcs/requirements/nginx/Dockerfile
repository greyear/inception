
FROM alpine:3.18
#официальный образ alpine, нам нельзя использовать лэйтест
#penultimate - второй с конца!

RUN apk update && apk add --no-cache nginx openssl
#openssl может понадобиться для генерации сертификатов или для утилит управления TLS

RUN mkdir -p /run/nginx
#создаем папку для хранения runtime файлов nginx

COPY ./conf/nginx.conf /etc/nginx/nginx.conf
#копируем наш конфиг nginx в контейнер

EXPOSE 443
#говорим докеру, что контейнер слушает порт 443

CMD ["nginx", "-g", "daemon off;"]
# запускаем nginx в фореграунд режиме (иначе контейнер сразу завершится)
#демон это программа, которая работает в фоне и не занимает терминал
#nginx по умолчанию запускается как демон, поэтому мы переопределяем это поведение